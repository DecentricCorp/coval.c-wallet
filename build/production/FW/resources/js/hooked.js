var pages=[];var pageHookElement=function(){return $(".hook")};var timerTick=0;const baseTickTimer=500;const tickDecayTrigger=60;const timerHalt=85;var hookedEngineTimeout;var hookEngineRunning=false;$(document).ready(function(){console.log("App Hooked");console.log("Starting to look for page hook");hookCheckEngine(function(){registerListeners()})});function hookCheckEngine(a){hookEngineRunning=true;checkIfOnHooked(function(b){calculateCurrentPages(b,function(){resetTick();console.log("On hooked pages():",pages);return a()})})}function resetTick(){clearTimeout(hookedEngineTimeout);hookEngineRunning=false;timerTick=0}function checkIfOnHooked(a){checkForHaltCondition(function(b){if(b){console.log("Giving up after ",timerTick,"ticks");return a(pageHookElement())}hookedEngineTimeout=setTimeout(function(){onHookedPage(function(c){if(c){return a(pageHookElement())}return checkIfOnHooked(a)})},throttledTimer())})}function throttledTimer(){timerTick++;var a=baseTickTimer;if(timerTick>=tickDecayTrigger){a=a*(timerTick-tickDecayTrigger)}return a}function checkForHaltCondition(a){return a(timerTick>=timerHalt)}function onHookedPage(a){var b=pageHookElement().is(":visible");console.log("Hook found?",b);return a(b)}function filterOnlyVisible(b){var a=b.filter(function(c){return $(b[c]).is(":visible")==true});return a}function calculateCurrentPages(d,a){d=filterOnlyVisible(d);var e=d.length;pages=[];for(var c=0;c<e;c++){var b=d[c].getAttribute("data-page");pages[c]={hook:d[c],page:b};console.log("(DEBUG)","page:",c,"is",b)}return a()}function registerListeners(){console.log("Registered event listeners");var b=$(".x-container");var d=window.MutationObserver||window.WebKitMutationObserver;var e=new d(a);var c={childList:true,characterData:true,attributes:true,subtree:true};b.each(function(){e.observe(this,c)});function a(f){fireContentChangedHookCheck()}}function fireContentChangedHookCheck(){if(timerTick>tickDecayTrigger){console.log("decay triggered, lets reset to allow a new fast hook check");resetTick()}if(!hookEngineRunning){console.log("safe to start content changed hook engine");hookCheckEngine(function(){console.log("Hook check complete")})}};